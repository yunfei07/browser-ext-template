{"version":3,"file":"content.js","sources":["../../src/content/index.ts"],"sourcesContent":["const HIGHLIGHT_STYLE_ID = \"__ext_highlight_style\";\n\nconst ensureHighlightStyle = () => {\n  if (document.getElementById(HIGHLIGHT_STYLE_ID)) return;\n  const style = document.createElement(\"style\");\n  style.id = HIGHLIGHT_STYLE_ID;\n  style.textContent = `\n    .ext-highlight {\n      background: rgba(34, 211, 238, 0.35);\n      box-shadow: 0 0 0 1px rgba(34, 211, 238, 0.7);\n      border-radius: 4px;\n      padding: 0 2px;\n      transition: box-shadow 160ms ease, background 160ms ease;\n    }\n    .ext-highlight:hover {\n      box-shadow: 0 0 0 2px rgba(34, 211, 238, 0.9);\n      background: rgba(34, 211, 238, 0.45);\n    }\n  `;\n  document.head.appendChild(style);\n};\n\nconst highlightSelection = () => {\n  const selection = window.getSelection();\n  if (!selection || selection.rangeCount === 0) {\n    return { ok: false, message: \"未选中文字\" };\n  }\n\n  const text = selection.toString().trim();\n  if (!text) {\n    return { ok: false, message: \"未选中文字\" };\n  }\n\n  const range = selection.getRangeAt(0);\n  const wrapper = document.createElement(\"span\");\n  wrapper.className = \"ext-highlight\";\n\n  try {\n    const contents = range.extractContents();\n    wrapper.appendChild(contents);\n    range.insertNode(wrapper);\n    selection.removeAllRanges();\n    return { ok: true, message: `已高亮：${text.slice(0, 40)}` };\n  } catch (error) {\n    return { ok: false, message: `无法高亮：${(error as Error).message}` };\n  }\n};\n\nchrome.runtime.sendMessage({ type: \"CONTENT_READY\" });\n\nchrome.runtime.onMessage.addListener((message, _sender, sendResponse) => {\n  if (message?.type === \"PING_FROM_POPUP\") {\n    sendResponse({ message: \"content script 已收到 Ping\" });\n    return;\n  }\n\n  if (message?.type === \"HIGHLIGHT_SELECTION\") {\n    ensureHighlightStyle();\n    const result = highlightSelection();\n    sendResponse(result);\n    return;\n  }\n});\n"],"names":["HIGHLIGHT_STYLE_ID","ensureHighlightStyle","style","highlightSelection","selection","text","range","wrapper","contents","error","message","_sender","sendResponse","result"],"mappings":"AAAA,MAAMA,EAAqB,wBAErBC,EAAuB,IAAM,CACjC,GAAI,SAAS,eAAeD,CAAkB,EAAG,OACjD,MAAME,EAAQ,SAAS,cAAc,OAAO,EAC5CA,EAAM,GAAKF,EACXE,EAAM,YAAc;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAapB,SAAS,KAAK,YAAYA,CAAK,CACjC,EAEMC,EAAqB,IAAM,CAC/B,MAAMC,EAAY,OAAO,aAAA,EACzB,GAAI,CAACA,GAAaA,EAAU,aAAe,EACzC,MAAO,CAAE,GAAI,GAAO,QAAS,OAAA,EAG/B,MAAMC,EAAOD,EAAU,SAAA,EAAW,KAAA,EAClC,GAAI,CAACC,EACH,MAAO,CAAE,GAAI,GAAO,QAAS,OAAA,EAG/B,MAAMC,EAAQF,EAAU,WAAW,CAAC,EAC9BG,EAAU,SAAS,cAAc,MAAM,EAC7CA,EAAQ,UAAY,gBAEpB,GAAI,CACF,MAAMC,EAAWF,EAAM,gBAAA,EACvB,OAAAC,EAAQ,YAAYC,CAAQ,EAC5BF,EAAM,WAAWC,CAAO,EACxBH,EAAU,gBAAA,EACH,CAAE,GAAI,GAAM,QAAS,OAAOC,EAAK,MAAM,EAAG,EAAE,CAAC,EAAA,CACtD,OAASI,EAAO,CACd,MAAO,CAAE,GAAI,GAAO,QAAS,QAASA,EAAgB,OAAO,EAAA,CAC/D,CACF,EAEA,OAAO,QAAQ,YAAY,CAAE,KAAM,gBAAiB,EAEpD,OAAO,QAAQ,UAAU,YAAY,CAACC,EAASC,EAASC,IAAiB,CACvE,IAAIF,GAAA,YAAAA,EAAS,QAAS,kBAAmB,CACvCE,EAAa,CAAE,QAAS,0BAA2B,EACnD,MACF,CAEA,IAAIF,GAAA,YAAAA,EAAS,QAAS,sBAAuB,CAC3CT,EAAA,EACA,MAAMY,EAASV,EAAA,EACfS,EAAaC,CAAM,EACnB,MACF,CACF,CAAC"}